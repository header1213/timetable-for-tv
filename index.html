<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      @import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css");
      body {
        margin: 0;
        padding: 0;
        font-family: "pretendard";
      }
      #시간표 {
        margin: 2vh 1vw;
        height: 96vh;
        width: 98vw;
        background-color: #003300;

        padding: 10px;
      }
      table,
      tr,
      td {
        border: 2px solid white;
        border-collapse: collapse;
        text-align: center;
      }
      thead td {
        color: white;
        font-weight: 300;
      }
      td:first-child {
        color: white;
        font-weight: 300;
        width: 6vw;
      }
      td {
        color: white;
        font-weight: 500;
        font-size: 2vw;
        width: 13vw;
      }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>3학년 4반 1학기 시간표</title>
  </head>
  <body>
    <table id="시간표">
      <thead id="교시">
        <td>요일</td>
        <td>1교시</td>
        <td>2교시</td>
        <td>3교시</td>
        <td>4교시</td>
        <td>5교시</td>
        <td>6교시</td>
        <td>7교시</td>
      </thead>
    </table>
  </body>

  <script>
    const days = ["월요일", "화요일", "수요일", "목요일", "금요일"];
    const table = [
      [
        ["공업일반", "이호성"],
        ["DB 구축", "김혁준"],
        ["진로", "전유원"],
        ["비영 B", "전유원"],
        ["미적분", "김재영"],
        [
          ["시프", "오종찬"],
          ["네프", "안수진"],
          ["컴그", "정희범"],
        ],
        ["HR", ""],
      ],
      [
        [
          ["응개", "마성옥"],
          ["컴보", "오종찬"],
        ],
        [
          ["응개", "마성옥"],
          ["컴보", "오종찬"],
        ],
        ["비영 B", "전유원"],
        ["공수 A", "이효현"],
        [
          ["시프", "오종찬"],
          ["네프", "김재영"],
          ["컴그", "정희범"],
        ],
        ["DB 구축", "김혁준"],
        ["진로", "전유원"],
      ],
      [
        ["공업일반", "이호성"],
        ["고전 읽기", "성기하"],
        ["비영 A", "공정도"],
        [
          ["시프", "오종찬"],
          ["네프", "함지연"],
          ["컴그", "정희범"],
        ],
        ["DB 구축", "김혁준"],
        ["CA", ""],
      ],
      [
        ["공수 A", "이효현"],
        [
          ["응개", "마성옥"],
          ["컴보", "오종찬"],
        ],
        [
          ["응개", "마성옥"],
          ["컴보", "오종찬"],
        ],
        ["비영 A", "공정도"],
        ["미적분", "김재영"],
        [
          ["미래", "하미영"],
          ["네구", "임재훈"],
          ["음콘", "박수영"],
        ],
        [
          ["미래", "하미영"],
          ["네구", "임재훈"],
          ["음콘", "박수영"],
        ],
      ],
      [
        ["공수 B", "김재영"],
        ["공업일반", "이호성"],
        ["DB 구축", "김혁준"],
        [
          ["응개", "마성옥"],
          ["컴보", "오종찬"],
        ],
        ["고전 읽기", "성기하"],
        [
          ["미래", "하미영"],
          ["네구", "임재훈"],
          ["방콘", "정희범"],
        ],
        [
          ["미래", "하미영"],
          ["네구", "임재훈"],
          ["방콘", "정희범"],
        ],
      ],
    ];

    // const make_class = (classtime) => `${classtime[0]}`;
    const make_class = (classtime) => `<ruby>${classtime[0]}<rp>(</rp><rt>${classtime[1]}</rt><rp>)</rp></ruby>`;

    for (let i = 0; i < 5; i++) {
      let day = $("<tr>").attr("id", days[i]).append($("<td>").text(days[i]));
      table[i].forEach((time) => {
        let text = "";

        if (typeof time[0] == "string") {
          text = make_class(time);
        } else {
          let classtimes = [];
          time.forEach((classtime) => {
            classtimes.push(make_class(classtime));
          });
          text = classtimes.join("/");
        }

        day.append($("<td>").html(text));
      });
      $("#시간표").append(day);
    }

    const Time = (...t) => t.reduce((r, next) => r * 60 + next, 0);
    const lightup = () => {
      now = new Date();
      today = now.getDay();

      let time = Time(now.getHours(), now.getMinutes());
      console.log(time);
      let classtime;
      if (time <= Time(9, 50)) classtime = 1;
      else if (time <= Time(10, 50)) classtime = 2;
      else if (time <= Time(11, 50)) classtime = 3;
      else if (time <= Time(13, 40)) classtime = 4;
      else if (time <= Time(14, 40)) classtime = 5;
      else if (time <= Time(15, 40)) classtime = 6;
      else if (time <= Time(16, 40)) classtime = 7;
      else classtime = -1;

      $(`tr:nth-child(${today})`).css("background-color", "#003300");
      $(`tr:nth-child(${today + 1})`).css("background-color", "#006600");
      $(`tr:nth-child(${today + 1}) td:nth-child(${classtime})`).css("background-color", "#006600");
      $(`tr:nth-child(${today + 1}) td:nth-child(${classtime + 1})`).css("background-color", "#009900");
    };
    lightup();
    setInterval(lightup, 60000);
  </script>
</html>
